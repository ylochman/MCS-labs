
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    \usepackage[english,main=ukrainian]{babel}
    \usepackage{indentfirst}    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Protocol}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \begin{titlepage} 
\center

{\large
Національний Технічний Університет України\\[0.2cm]
«Київський політехнічний інститут імені Ігоря Сікорського»\\[0.2cm]
Навчально-Науковий Комплекс \\[0.2cm]
«Інститут прикладного системного аналізу»
}\\[4cm] % Minor heading such as course title


{ \LARGE \bfseries
Лабороторна робота № 3 \\[0.4cm]
з дисципліни «Моделювання складних систем»
}\\[5cm] % Title of your document

\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Виконали:} \\
студенти гр. КА-41 \\
Мельничук Валентин \\
Лочман Ярослава  \\
Снігірьова Валерія
\end{flushleft}
\end{minipage}
~
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Прийняв:} \\
професор кафедри ММСА, \\
д.т.н. Степашко В.С. \\
\end{flushright}
\end{minipage}\\[5cm]

Київ 2018

\vfill % Fill the rest of the page with whitespace

\end{titlepage}

    \section{Пошук моделі оптимальної
складності}\label{ux43fux43eux448ux443ux43a-ux43cux43eux434ux435ux43bux456-ux43eux43fux442ux438ux43cux430ux43bux44cux43dux43eux457-ux441ux43aux43bux430ux434ux43dux43eux441ux442ux456}

    Метою роботи є пошук моделі оптимальної складності, причому наперед не
відомо, яку саме підмножину всіх регресорів/аргументів містить така
модель. Тому необхідно сконструювати і перевірити алгоритми для її
пошуку.

    \subsection{Задання конфігурацій. Створення
вибірок}\label{ux437ux430ux434ux430ux43dux43dux44f-ux43aux43eux43dux444ux456ux433ux443ux440ux430ux446ux456ux439.-ux441ux442ux432ux43eux440ux435ux43dux43dux44f-ux432ux438ux431ux456ux440ux43eux43a}

    \subsubsection{Тест 1 (вибірка аналогічна вибірці з лабораторної роботи
№2)}\label{ux442ux435ux441ux442-1-ux432ux438ux431ux456ux440ux43aux430-ux430ux43dux430ux43bux43eux433ux456ux447ux43dux430-ux432ux438ux431ux456ux440ux446ux456-ux437-ux43bux430ux431ux43eux440ux430ux442ux43eux440ux43dux43eux457-ux440ux43eux431ux43eux442ux438-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}240}]:} \PY{n}{config1} \PY{o}{=} \PY{n}{ModelConfig}\PY{p}{(}\PY{n}{a}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{b}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
          \PY{n}{config1}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{n}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
          \PY{n}{config1}\PY{o}{.}\PY{n}{generate\PYZus{}noise\PYZus{}and\PYZus{}output}\PY{p}{(}\PY{p}{)}
          \PY{n}{config1}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Regressors: m = 5
True parameters: θ = [ 3 -2  1  0  0]
y0 = (3) * x1 + (-2) * x2 + (1) * x3 + (0) * x4 + (0) * x5
Noise generation: σ = 0.3
Sample length: n = 1000
X[:10]:
[[0.41874236 0.12456156 0.28066172 0.15910143 0.46122701]
 [0.18105384 0.37716676 0.27709214 0.4888375  0.44187549]
 [0.39936274 0.38647222 0.15799907 0.23559202 0.17128673]
 [0.37188136 0.0734651  0.4625002  0.4584715  0.46049963]
 [0.16993313 0.00577501 0.10517818 0.41488992 0.02465976]
 [0.4015307  0.10460762 0.01333114 0.121193   0.45949378]
 [0.04337896 0.04571534 0.09617543 0.36648325 0.33861697]
 [0.43594373 0.13017585 0.14422878 0.09106459 0.30376701]
 [0.08004885 0.45564509 0.42793286 0.25046363 0.11175226]
 [0.24495675 0.28230842 0.13494233 0.00910952 0.08285733]]
y[:10]:
[ 1.54708203  0.37647857  0.09577151  1.52671753  0.3847499   0.94908614
  0.05493975  0.96470431 -0.44266497 -0.01847096]

    \end{Verbatim}

    \subsubsection{Тест 2 (велика вибірка з великою кількістю
регресорів)}\label{ux442ux435ux441ux442-2-ux432ux435ux43bux438ux43aux430-ux432ux438ux431ux456ux440ux43aux430-ux437-ux432ux435ux43bux438ux43aux43eux44e-ux43aux456ux43bux44cux43aux456ux441ux442ux44e-ux440ux435ux433ux440ux435ux441ux43eux440ux456ux432}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}275}]:} \PY{n}{config2} \PY{o}{=} \PY{n}{ModelConfig}\PY{p}{(}\PY{n}{m}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{s0}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{a}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{b}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{theta}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{random}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}
          \PY{n}{config2}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{n}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
          \PY{n}{config2}\PY{o}{.}\PY{n}{generate\PYZus{}noise\PYZus{}and\PYZus{}output}\PY{p}{(}\PY{p}{)}
          \PY{n}{config2}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Regressors: m = 15
True parameters: θ = [1.08631304 7.56699925 9.87829854 1.23698103 1.95130363 7.51601044
 3.30060728 9.37353548 8.89118059 5.43780306 0.         0.
 0.         0.         0.        ]
y0 = (1.0863130375942172) * x1 + (7.5669992531306685) * x2 + (9.878298535051083) * x3 + 
(1.2369810327923685) * x4 + (1.9513036347108885) * x5 + (7.516010436428849) * x6 + 
(3.3006072776149766) * x7 + (9.373535481004593) * x8 + (8.891180588599674) * x9 + 
(5.437803059763569) * x10 + (0.0) * x11 + (0.0) * x12 + (0.0) * x13 + (0.0) * x14 + (0.0) * x15
Noise generation: σ = 0.3
Sample length: n = 1000
X[:10]:
[[0.1705477  0.11570771 0.04892584 0.13072365 0.16437218 0.31504024
  0.14840706 0.11924657 0.09960202 0.22359233 0.43944381 0.23732165
  0.19519143 0.10417676 0.37984204]
 [0.0331949  0.40150537 0.25136752 0.44019061 0.45945587 0.21892163
  0.1898278  0.05924368 0.29950877 0.17212511 0.13291328 0.27488848
  0.40227747 0.21418697 0.207846  ]
 [0.48098721 0.09015798 0.1225068  0.33779223 0.17132909 0.29822888
  0.29883653 0.19555494 0.17036849 0.38940055 0.25217936 0.22981511
  0.11896126 0.4501579  0.22419701]
 [0.40599318 0.38085013 0.26163438 0.35836486 0.24301073 0.25737834
  0.21272382 0.40589793 0.25593534 0.29699694 0.07434101 0.32349888
  0.30363923 0.37264665 0.36211302]
 [0.06235834 0.23418489 0.43466777 0.34663551 0.10996189 0.19710446
  0.30886481 0.09920457 0.13226504 0.43110287 0.08626634 0.31482844
  0.33328672 0.11005692 0.07750284]]
y[:10]:
[ 8.30431374 13.50238474 12.2071761  17.13535375 13.8499516 ]

    \end{Verbatim}

    \subsubsection{Тест 3 (власні
задачі)}\label{ux442ux435ux441ux442-3-ux432ux43bux430ux441ux43dux456-ux437ux430ux434ux430ux447ux456}

    \paragraph{Вміст
октану}\label{ux432ux43cux456ux441ux442-ux43eux43aux442ux430ux43dux443}

При дослідженні виробничого процесу нафтопереробному заводі вимірюється
вміст октану в нафті залежно від кількості 3-х сировинних матеріалів та
змінної, що характеризує умови виробництва. Вхідні змінні (5):

\begin{itemize}
\tightlist
\item
  Кількість матеріалу 1
\item
  Кількість матеріалу 2
\item
  Кількість матеріалу 3
\item
  Кількісний показник умов виробництва
\item
  Одиниця, відповідає вільному члену
\end{itemize}

Вихідна змінна: 
\begin{itemize}
\tightlist
\item
    Вміст октану
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}242}]:} \PY{n}{dataframe\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data/octane\PYZhy{}rating.csv}\PY{l+s+s1}{\PYZsq{}}
          \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{dataframe\PYZus{}path}\PY{p}{)}
          \PY{n}{config3} \PY{o}{=} \PY{n}{ModelConfig}\PY{p}{(}\PY{n}{theta}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unknown}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                \PY{n}{X}\PY{o}{=}\PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{One}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Condition}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                \PY{n}{y}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Octane number}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{config3}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Regressors: m = 5
True parameters: θ = unknown
Sample length: n = 82
X[:10]:
[[ 1.      55.33     1.72    54.       1.66219]
 [ 1.      59.13     1.2     53.       1.58399]
 [ 1.      57.39     1.42    55.       1.61731]
 [ 1.      56.43     1.78    55.       1.66228]
 [ 1.      55.98     1.58    54.       1.63195]
 [ 1.      56.16     2.12    56.       1.68034]
 [ 1.      54.85     1.17    54.       1.58206]
 [ 1.      52.83     1.5     58.       1.54998]
 [ 1.      54.52     0.87    57.       1.5623 ]
 [ 1.      54.12     0.88    57.       1.57818]]
y[:10]:
[92.19 92.74 91.88 92.8  92.56 92.61 92.33 92.22 91.56 92.17]

    \end{Verbatim}

    \paragraph{Ціни на
нерухомість}\label{ux446ux456ux43dux438-ux43dux430-ux43dux435ux440ux443ux445ux43eux43cux456ux441ux442ux44c}

Вхідні змінні (36):

\begin{itemize}
\tightlist
\item
  Тип житла (номер)
\item
  Дистанція від вулиці до фасаду в футах
\item
  Розмір ділянки в квадратних футах
\item
  Загальна якість матеріалів та обробки
\item
  Загальний стан житла
\item
  Рік початку будівництва
\item
  Рік переробки
\item
  Площа фанери в квадратних футах
\item
  Площа підвалу 1 в квадратних футах
\item
  Площа підвалу 2 в квадратних футах
\item
  Площа підвалу (незробленого) в квадратних футах
\item
  Загальна площа підвалу в квадратних футах
\item
  Перший поверх, площа в квадратних футах
\item
  Другий поверх, площа в квадратних футах
\item
  Інші ділянки, площа в квадратних футах
\item
  Житлова площа квадратних футів
\item
  Підвал: кількість великих ванних кімнат
\item
  Підвал: кількість маленьких ванних кімнат
\item
  Вище рівня фундаменту: кількість великих ванних кімнат
\item
  Вище рівня фундаменту: кількість маленьких ванних кімнат
\item
  Кількість спалень вище рівня фундаменту
\item
  Кількість кухонь вище рівня фундаменту
\item
  Загальна кількість кімнат вище рівня фундаменту (не включає ванні
  кімнати)
\item
  Кількість камінів
\item
  Рік побудови гаража
\item
  Розмір гаража відносно автомобіля
\item
  Розмір гаража в квадратних футах
\item
  Площа деревини в квадратних метрах
\item
  площа відкритого веранди в квадратних футах
\item
  Закрита площа під'їзду в квадратних футах
\item
  три сезонних ганок площі в квадратних метрах
\item
  площа екранної ганку в квадратних футах
\item
  Площа басейну в квадратних футах
\item
  Змішаний показник
\item
  Місяць продажу (номер)
\item
  Рік продажу
\end{itemize}

Вихідна змінна: 
\begin{itemize}
\tightlist
\item
    Ціна на нерухомість в долларах
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}243}]:} \PY{n}{dataframe\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data/house\PYZhy{}prices\PYZhy{}cleaned.csv}\PY{l+s+s1}{\PYZsq{}}
          \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{dataframe\PYZus{}path}\PY{p}{)}
          \PY{n}{config3} \PY{o}{=} \PY{n}{ModelConfig}\PY{p}{(}\PY{n}{theta}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unknown}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                \PY{n}{X}\PY{o}{=}\PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSSubClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{YrSold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                \PY{n}{y}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SalePrice}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{config3}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Regressors: m = 36
True parameters: θ = unknown
Sample length: n = 1460
X[:10]:
[[4.11087386e+00 4.18965474e+00 9.04204006e+00 7.00000000e+00
  5.00000000e+00 2.00300000e+03 2.00300000e+03 5.28320373e+00
  6.56103067e+00 0.00000000e+00 5.01727984e+00 6.75343792e+00
  6.75343792e+00 6.75110147e+00 0.00000000e+00 7.44483327e+00
  1.00000000e+00 0.00000000e+00 2.00000000e+00 1.00000000e+00
  3.00000000e+00 6.93147181e-01 8.00000000e+00 0.00000000e+00
  2.00300000e+03 2.00000000e+00 5.48000000e+02 0.00000000e+00
  4.12713439e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 2.00000000e+00 2.00800000e+03]]
y[:10]:
[12.24769912]

    \end{Verbatim}

    Далі в якості Теста 3 розглядатимемо саме ціни на нерухомість, оскільки
ця задача є цікавішою. При захисті роботи продемонструємо дослідження
також і для першої вибірки.

    \subsection{Пошук моделі. Послідовне включення (метод з лабораторної
роботи
№2)}\label{ux43fux43eux448ux443ux43a-ux43cux43eux434ux435ux43bux456.-ux43fux43eux441ux43bux456ux434ux43eux432ux43dux435-ux432ux43aux43bux44eux447ux435ux43dux43dux44f-ux43cux435ux442ux43eux434-ux437-ux43bux430ux431ux43eux440ux430ux442ux43eux440ux43dux43eux457-ux440ux43eux431ux43eux442ux438-2}

    \subsubsection{Тест 1}\label{ux442ux435ux441ux442-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}244}]:} \PY{n}{df1} \PY{o}{=} \PY{n}{config1}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{p}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                                                 \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                 \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
          \PY{n}{df2} \PY{o}{=} \PY{n}{config1}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{p}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reverse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                 \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                 \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
=============
DIRECT
=============
Regressors order:
	[1 2 3 4 5]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Optimal:
	s* = 3
	regressors = [1, 2, 3]
	theta* = [ 2.93417679 -1.95807657  0.96119887  0.          0.        ]

=============
REVERSE
=============
Regressors order:
	[5 4 3 2 1]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Optimal:
	s* = 5
	regressors = [1, 2, 3, 4, 5]
	theta* = [ 2.92528656 -1.96404659  0.94802332 -0.04141331  0.07425203]

    \end{Verbatim}

    Як видно, при прямому порядку критерій \(C_p\) має мінімум в точці
\(s=3\). А при зворотньому - в точці \(s=5\). Алгоритм МНКО діє
послідовно в порядку розташування регресорів, а в другому випадку
найбільш впливові регресори були в як раз кінці. Тому перші, ті що не
впливові, залишаються за критерієм, хоча, насправді, їх треба вилучити.

    \subsubsection{Тест 2}\label{ux442ux435ux441ux442-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}264}]:} \PY{n}{df1} \PY{o}{=} \PY{n}{config2}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{p}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                                                 \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                 \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
          \PY{n}{df2} \PY{o}{=} \PY{n}{config2}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{p}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reverse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                 \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                 \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
=============
DIRECT
=============
Regressors order:
	[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Optimal:
	s* = 10
	regressors = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
	theta* = [5.34957983 7.68519352 3.23045789 1.43320723 8.99113426 4.04264347
 8.02605224 6.64152218 2.25299834 9.43014176 0.         0.
 0.         0.         0.        ]

=============
REVERSE
=============
Regressors order:
	[15 14 13 12 11 10  9  8  7  6  5  4  3  2  1]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Optimal:
	s* = 15
	regressors = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
	theta* = [ 5.35884827  7.69388952  3.22576623  1.43850351  8.99698342  4.05267537
  8.03636612  6.64606609  2.26220489  9.4353677   0.0189138  -0.07486503
 -0.03273382  0.05130706 -0.02752136]

    \end{Verbatim}

    Ситуація дуже схожа на Тест 1: при прямому порядку критерій \(C_p\) має
мінімум в точці \(s=10\). А при зворотньому - в точці \(s=15\). Тут (в
другому випадку) також найбільш впливові регресори в кінці, а невпливові
на початку, і алгоритм пропонує враховувати всі регресори, що є не дуже
добре.

    \subsubsection{Тест 3}\label{ux442ux435ux441ux442-3}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}256}]:} \PY{n}{df1} \PY{o}{=} \PY{n}{config3}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{p}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                                                 \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                 \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
          \PY{n}{df2} \PY{o}{=} \PY{n}{config3}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{p}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reverse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                 \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                 \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
=============
DIRECT
=============
Regressors order:
	[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31 32 33 34 35 36]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Optimal:
	s* = 14
	regressors = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
	theta* = [-1.28216774e-02  1.35851253e-05  1.01151515e-01  1.25308956e-01
  4.12106912e-02  3.12536597e-03  3.92878638e-04 -4.94563644e-06
  1.29231644e-02 -2.45073557e-03 -3.51982786e-03  1.69078657e-02
  4.24867319e-01  3.14435771e-02  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]

=============
REVERSE
=============
Regressors order:
	[36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13
 12 11 10  9  8  7  6  5  4  3  2  1]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Optimal:
	s* = 23
	regressors = [14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
	theta* = [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -2.61098624e-02 -2.95063243e-02  6.48993849e-01
  9.19192746e-02  6.26520803e-02  1.20066421e-01  6.97063260e-02
 -4.17975867e-02 -7.73319356e-01  1.55498563e-02  3.57490733e-02
 -5.79498604e-07  9.78581656e-02  9.61967394e-05  9.14427971e-03
  1.01267236e-02 -8.23456848e-03  7.53719402e-03  7.69962763e-03
 -1.80806774e-02 -4.87035069e-03  1.07276179e-03  3.69006574e-03]

    \end{Verbatim}

    При прямому порядку критерій \(C_p\) має мінімум в точці \(s=14\). А при
зворотньому - в точці \(s=23\). Виходить, результати алгоритмів
перетинаються тільки в одному регресорі - №14. Це повинно бути
спричиненим тим, що впливові регресори знаходиться як на початку, так і
в середині, так і в кінці; а неінформативні розташовані серед них
довільно.

    \subsection{Пошук моделі. Метод кореляційного
включення}\label{ux43fux43eux448ux443ux43a-ux43cux43eux434ux435ux43bux456.-ux43cux435ux442ux43eux434-ux43aux43eux440ux435ux43bux44fux446ux456ux439ux43dux43eux433ux43e-ux432ux43aux43bux44eux447ux435ux43dux43dux44f}

    \subsubsection{Тест 1}\label{ux442ux435ux441ux442-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}257}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True parameters: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{config1}\PY{o}{.}\PY{n}{theta}\PY{p}{)}\PY{p}{)}
          \PY{n}{df1} \PY{o}{=} \PY{n}{config1}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{p}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{correlation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                 \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                 \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
True parameters: [ 3 -2  1  0  0]
=====================
CORRELATION INCLUDING
=====================
Correlations with target:
	[0.06608656 0.04732197 0.0214448  0.00308982 0.00320026]
Regressors order:
	[1 2 3 5 4]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_26_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Optimal:
	s* = 3
	regressors = [1, 2, 3]
	theta* = [ 2.93417679 -1.95807657  0.96119887  0.          0.        ]

    \end{Verbatim}

    Як видно, кореляції з вихідною величиною останніх двох регресорів на
порядок менші за перших трьох, тому вони знаходяться в кінці, і критерій
має мінімум в точці \(s=3\), що означає - не враховувати ці два останні
регресори, а це є якраз оптимально.

    \subsubsection{Тест 2}\label{ux442ux435ux441ux442-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}277}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True parameters: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{config2}\PY{o}{.}\PY{n}{theta}\PY{p}{)}\PY{p}{)}
          \PY{n}{df1} \PY{o}{=} \PY{n}{config2}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{p}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{correlation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                 \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                 \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
True parameters: [1.08631304 7.56699925 9.87829854 1.23698103 1.95130363 7.51601044
 3.30060728 9.37353548 8.89118059 5.43780306 0.         0.
 0.         0.         0.        ]
=====================
CORRELATION INCLUDING
=====================
Correlations with target:
	[3.83305152e-02 1.55625374e-01 2.09276844e-01 1.39829913e-02
 2.83244475e-02 1.57539656e-01 6.13691829e-02 1.90083208e-01
 2.06724138e-01 1.23777841e-01 1.24969261e-02 6.35983396e-04
 1.01440860e-04 3.86404508e-03 1.67161737e-03]
Regressors order:
	[ 3  9  8  6  2 10  7  1  5  4 11 14 15 12 13]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Optimal:
	s* = 10
	regressors = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
	theta* = [1.05876253 7.50327434 9.85888761 1.3377948  1.96155001 7.46867561
 3.35366087 9.27692936 9.01995245 5.40978014 0.         0.
 0.         0.         0.        ]

    \end{Verbatim}

    Кореляції всіх неінформативних регресорів дуже малі - порядка -3, -4, що
спричинене шумами. В результаті, розмістивши їх в кінці, критерій має
мінімум в точці \(s=10\), що якраз відповідає врахуванню тільки
впливових регресорів.

    \subsubsection{Тест 3}\label{ux442ux435ux441ux442-3}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}279}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True parameters: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{config3}\PY{o}{.}\PY{n}{theta}\PY{p}{)}\PY{p}{)}
          \PY{n}{df1} \PY{o}{=} \PY{n}{config3}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{p}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{correlation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                 \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                 \PY{n}{plot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
True parameters: unknown
=====================
CORRELATION INCLUDING
=====================
Correlations with target:
	[5.57596614e-03 4.96374698e+00 8.26491953e-02 4.51442989e-01
 1.63882816e-02 7.07669256e+00 4.66445015e+00 1.63966386e+00
 2.48714016e-01 2.23758820e-02 1.54214723e-01 1.70630669e-01
 7.72140589e-02 2.37815311e-01 1.62738556e-02 9.72242664e-02
 4.89641813e-02 3.17601408e-04 1.30886967e-01 6.30718701e-02
 6.81193001e-02 5.14465628e-03 3.46980247e-01 1.26038896e-01
 4.16687853e+01 2.03176351e-01 5.55885342e+01 3.55780446e-01
 3.95449211e-01 1.43006510e-01 1.56705081e-02 5.93336132e-02
 1.22572971e-02 3.28385950e-02 6.19136590e-02 1.97682209e-02]
Regressors order:
	[27 25  6  2  7  8  4 29 28 23  9 14 26 12 11 30 19 24 16  3 13 21 20 35
 32 17 34 10 36  5 15 31 33  1 22 18]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Optimal:
	s* = 11
	regressors = [2, 4, 6, 7, 8, 9, 23, 25, 27, 28, 29]
	theta* = [ 0.00000000e+00  6.16508069e-05  0.00000000e+00  1.17978290e-01
  0.00000000e+00  1.62350673e-03  3.69267563e-03 -3.26930295e-06
  2.14658894e-02  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  6.47731113e-02  0.00000000e+00
  5.15876051e-05  0.00000000e+00  2.72399131e-04  5.69459418e-03
  5.16573136e-03  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]

    \end{Verbatim}

    Інформації щодо істинного впливу регресорів на вихідну змінну в цій
задачі ми не маємо, тому можемо робити висновки тільки на основі
розроблених методів пошуку оптимальної складності. Даний алгоритм
показує, що з вихідною величиною дуже корелюють два регресори, для яких
значення кореляції мають порядок 1: це 27 і 25; чотири регресори мають
кореляції порядка 0: це 6, 2, 7 і 8. Далі 12 регресорів, для яких
кореляції порядка -1, і для інших ще менше. Розташувавши регресори
відповідно до кореляцій і виконавши МНКО, маємо мінімум критерія в точці
\(s=11\), і, дійсно, алгоритм пропонує регресори як з початку (відносно
розташування в оригінальній матриці Х), так і з кінця, тобто гіпотези,
описані вище, підтверджуються.

    \subsection{Пошук моделі. Метод випадкового
включення}\label{ux43fux43eux448ux443ux43a-ux43cux43eux434ux435ux43bux456.-ux43cux435ux442ux43eux434-ux432ux438ux43fux430ux434ux43aux43eux432ux43eux433ux43e-ux432ux43aux43bux44eux447ux435ux43dux43dux44f}

    \subsubsection{Тест 1}\label{ux442ux435ux441ux442-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}282}]:} \PY{n}{Ks} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{]}
          \PY{k}{for} \PY{n}{K} \PY{o+ow}{in} \PY{n}{Ks}\PY{p}{:}
              \PY{n}{config1}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}random\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{K}\PY{o}{=}\PY{n}{K}\PY{p}{,} \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                             \PY{n}{main\PYZus{}criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
================================
RANDOM INCLUDING WITH K = 10
================================

  s*      regressors*         Cp
0  4     [1, 2, 3, 5]  95.907950
1  4     [1, 2, 3, 4]  96.001499
2  5  [1, 2, 3, 4, 5]  97.865019
3  5  [1, 2, 3, 4, 5]  97.865019
4  5  [1, 2, 3, 4, 5]  97.865019
{\ldots}
  s*      regressors*         Cp
5  5  [1, 2, 3, 4, 5]  97.865019
6  4     [1, 2, 3, 5]  95.907950
7  4     [1, 2, 3, 5]  95.907950
8  5  [1, 2, 3, 4, 5]  97.865019
9  5  [1, 2, 3, 4, 5]  97.865019

Optimal:
	s* = 4
	regressors = [1, 2, 3, 5]
================================
RANDOM INCLUDING WITH K = 20
================================

  s*      regressors*         Cp
0  4     [1, 2, 3, 5]  95.907950
1  4     [1, 2, 3, 4]  96.001499
2  4     [1, 2, 3, 4]  96.001499
3  5  [1, 2, 3, 4, 5]  97.865019
4  5  [1, 2, 3, 4, 5]  97.865019
{\ldots}
   s*      regressors*         Cp
15  5  [1, 2, 3, 4, 5]  97.865019
16  5  [1, 2, 3, 4, 5]  97.865019
17  4     [1, 2, 3, 5]  95.907950
18  4     [1, 2, 3, 5]  95.907950
19  4     [1, 2, 3, 4]  96.001499

Optimal:
	s* = 3
	regressors = [1, 2, 3]
================================
RANDOM INCLUDING WITH K = 50
================================

  s*      regressors*         Cp
0  4     [1, 2, 3, 5]  95.907950
1  4     [1, 2, 3, 5]  95.907950
2  3        [1, 2, 3]  94.017191
3  5  [1, 2, 3, 4, 5]  97.865019
4  5  [1, 2, 3, 4, 5]  97.865019
{\ldots}
   s*      regressors*         Cp
45  4     [1, 2, 3, 4]  96.001499
46  4     [1, 2, 3, 5]  95.907950
47  5  [1, 2, 3, 4, 5]  97.865019
48  3        [1, 2, 3]  94.017191
49  5  [1, 2, 3, 4, 5]  97.865019

Optimal:
	s* = 3
	regressors = [1, 2, 3]
================================
RANDOM INCLUDING WITH K = 100
================================

  s*      regressors*         Cp
0  5  [1, 2, 3, 4, 5]  97.865019
1  4     [1, 2, 3, 4]  96.001499
2  4     [1, 2, 3, 5]  95.907950
3  5  [1, 2, 3, 4, 5]  97.865019
4  4     [1, 2, 3, 5]  95.907950
{\ldots}
   s*      regressors*         Cp
95  5  [1, 2, 3, 4, 5]  97.865019
96  5  [1, 2, 3, 4, 5]  97.865019
97  5  [1, 2, 3, 4, 5]  97.865019
98  5  [1, 2, 3, 4, 5]  97.865019
99  5  [1, 2, 3, 4, 5]  97.865019

Optimal:
	s* = 3
	regressors = [1, 2, 3]

    \end{Verbatim}

    При \(K>=20\) маємо стабільно правильний вибір регресорів. А при меншій
кількості випадкових формувань послідовностей метод все ще може
враховувати неінформативні регресори. Тож робимо висновок, що
\(K\approx20\) буде достатньо для побудови правильної моделі.

    \subsubsection{Тест 2}\label{ux442ux435ux441ux442-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}289}]:} \PY{n}{Ks} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{]}
          \PY{k}{for} \PY{n}{K} \PY{o+ow}{in} \PY{n}{Ks}\PY{p}{:}
              \PY{n}{config2}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}random\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{K}\PY{o}{=}\PY{n}{K}\PY{p}{,} \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                             \PY{n}{main\PYZus{}criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
================================
RANDOM INCLUDING WITH K = 50
================================

   s*                                        regressors*          Cp
0  13        [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15]  109.052547
1  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15]  111.077234
2  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15]  111.077234
3  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
4  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
{\ldots}
    s*                                        regressors*          Cp
45  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
46  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
47  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
48  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
49  13        [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15]  109.051216

Optimal:
	s* = 12
	regressors = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
================================
RANDOM INCLUDING WITH K = 100
================================

   s*                                        regressors*          Cp
0  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
1  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
2  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
3  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
4  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15]  111.050814
{\ldots}
    s*                                        regressors*          Cp
95  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15]  111.013007
96  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15]  111.013640
97  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]  111.073273
98  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
99  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15]  111.013640

Optimal:
	s* = 12
	regressors = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13]
================================
RANDOM INCLUDING WITH K = 200
================================

   s*                                        regressors*          Cp
0  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
1  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
2  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]  111.073273
3  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
4  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
{\ldots}
     s*                                        regressors*          Cp
195  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
196  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
197  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
198  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
199  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982

Optimal:
	s* = 10
	regressors = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
================================
RANDOM INCLUDING WITH K = 500
================================

   s*                                        regressors*          Cp
0  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
1  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15]  111.050814
2  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
3  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
4  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
{\ldots}
     s*                                        regressors*          Cp
495  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
496  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15]  111.013007
497  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982
498  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15]  111.077234
499  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}  113.012982

Optimal:
	s* = 11
	regressors = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15]

    \end{Verbatim}

    В даній задачі за результатами дослідження видно, що алгоритм працює
дуже добре при досить великих \(K>=200\). При меншій кількості
випадкових формувань результат роботи менш стабільний (хоча і при
великих К не завжди стабільно правильний вибір), і менш точний, хоча і
набагато швидший. Тож \(K\approx200\) буде достатньо.

    \subsubsection{Тест 3}\label{ux442ux435ux441ux442-3}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}296}]:} \PY{n}{Ks} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{300}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{]}
          \PY{k}{for} \PY{n}{K} \PY{o+ow}{in} \PY{n}{Ks}\PY{p}{:}
              \PY{n}{config3}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}random\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{K}\PY{o}{=}\PY{n}{K}\PY{p}{,} \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                             \PY{n}{main\PYZus{}criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
================================
RANDOM INCLUDING WITH K = 10
================================

   s*                                        regressors*         Cp
0  13  [4, 7, 8, 13, 17, 18, 21, 24, 27, 28, 31, 33, 34]  68.367063
1  19  [1, 5, 7, 8, 9, 10, 11, 13, 14, 16, 18, 19, 22{\ldots}  79.815037
2  16  [4, 5, 8, 10, 11, 13, 15, 19, 21, 23, 24, 26, {\ldots}  75.638691
3  15  [2, 5, 7, 9, 14, 15, 16, 17, 18, 23, 25, 30, 3{\ldots}  89.511266
4  15  [2, 6, 10, 15, 17, 19, 20, 21, 23, 24, 26, 28,{\ldots}  92.807331
{\ldots}
   s*                                        regressors*         Cp
5  17  [1, 2, 3, 4, 8, 9, 10, 13, 17, 19, 22, 25, 26,{\ldots}  74.259286
6  10                [1, 2, 4, 5, 6, 16, 18, 26, 31, 34]  56.133457
7  19  [2, 3, 6, 7, 9, 11, 13, 15, 16, 18, 21, 22, 23{\ldots}  76.762696
8  10            [2, 10, 14, 15, 16, 22, 26, 27, 28, 36]  77.153497
9  19  [1, 3, 4, 6, 8, 9, 13, 15, 16, 17, 18, 22, 25,{\ldots}  71.940356

Optimal:
	s* = 10
	regressors = [1, 2, 4, 5, 6, 16, 18, 26, 31, 34]
================================
RANDOM INCLUDING WITH K = 20
================================

   s*                                        regressors*         Cp
0  11           [3, 6, 8, 9, 15, 16, 21, 22, 27, 29, 30]  69.034028
1  16  [1, 2, 3, 4, 6, 7, 11, 13, 14, 21, 22, 25, 28,{\ldots}  68.706982
2  27  [2, 3, 4, 5, 7, 8, 9, 11, 12, 14, 15, 16, 17, {\ldots}  84.964975
3  17  [1, 3, 5, 6, 7, 11, 12, 14, 17, 18, 23, 25, 26{\ldots}  87.369001
4  24  [2, 3, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,{\ldots}  89.806780
{\ldots}
    s*                                        regressors*         Cp
15  21  [1, 3, 4, 7, 10, 11, 13, 14, 15, 17, 18, 19, 2{\ldots}  76.975123
16   6                              [2, 4, 9, 16, 22, 36]  61.096358
17  16  [2, 3, 4, 5, 6, 8, 11, 12, 14, 16, 20, 24, 29,{\ldots}  63.854962
18  19  [2, 3, 5, 6, 7, 8, 10, 11, 15, 16, 17, 18, 19,{\ldots}  77.577881
19  13  [1, 6, 9, 15, 16, 20, 21, 22, 23, 26, 30, 33, 35]  71.786257

Optimal:
	s* = 6
	regressors = [2, 4, 9, 16, 22, 36]
================================
RANDOM INCLUDING WITH K = 50
================================

   s*                                        regressors*         Cp
0  18  [2, 6, 7, 8, 9, 12, 13, 14, 15, 17, 18, 21, 23{\ldots}  84.004745
1  21  [3, 4, 8, 9, 14, 16, 17, 18, 21, 22, 23, 24, 2{\ldots}  77.665279
2  20  [3, 4, 5, 7, 8, 11, 15, 16, 17, 18, 19, 21, 25{\ldots}  74.815123
3  23  [3, 7, 9, 12, 13, 14, 15, 17, 18, 19, 21, 23, {\ldots}  90.804127
4  13  [3, 4, 6, 12, 13, 14, 18, 19, 22, 23, 24, 30, 32]  63.870565
{\ldots}
    s*                                        regressors*         Cp
45  16  [3, 4, 7, 9, 10, 13, 16, 17, 18, 19, 21, 23, 2{\ldots}  65.603009
46  11           [2, 4, 5, 7, 13, 17, 18, 23, 24, 25, 34]  64.474391
47  15  [3, 4, 7, 8, 13, 14, 15, 16, 20, 22, 26, 28, 3{\ldots}  65.337222
48  29  [1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, {\ldots}  89.063137
49  10              [3, 5, 6, 19, 23, 24, 28, 29, 32, 35]  82.323554

Optimal:
	s* = 11
	regressors = [1, 2, 4, 5, 6, 7, 13, 14, 16, 17, 18]
================================
RANDOM INCLUDING WITH K = 100
================================

   s*                                        regressors*         Cp
0  14  [2, 4, 7, 8, 11, 12, 13, 17, 19, 26, 28, 32, 3{\ldots}  71.596149
1  23  [1, 2, 3, 4, 5, 7, 10, 11, 14, 15, 16, 17, 20,{\ldots}  78.035155
2   8                      [4, 6, 7, 13, 19, 23, 24, 26]  57.358204
3  18  [2, 4, 5, 7, 8, 11, 12, 15, 16, 19, 22, 23, 24{\ldots}  74.717910
4  15  [3, 4, 9, 11, 12, 15, 17, 19, 20, 28, 30, 31, {\ldots}  74.383302
{\ldots}
    s*                                        regressors*         Cp
95  15  [2, 4, 5, 7, 13, 14, 17, 18, 19, 25, 26, 27, 2{\ldots}  68.784865
96   6                             [2, 4, 17, 18, 26, 36]  71.431696
97  25  [1, 2, 3, 4, 6, 8, 9, 10, 12, 13, 14, 15, 16, {\ldots}  83.179062
98  21  [1, 4, 5, 6, 8, 9, 10, 13, 14, 16, 17, 18, 21,{\ldots}  73.345661
99  11          [4, 7, 9, 10, 13, 14, 19, 22, 26, 32, 36]  58.853253

Optimal:
	s* = 10
	regressors = [3, 4, 6, 7, 10, 16, 22, 24, 26, 30]
================================
RANDOM INCLUDING WITH K = 300
================================

   s*                                        regressors*         Cp
0  10               [1, 3, 4, 7, 12, 16, 17, 26, 30, 36]  55.471972
1  14  [1, 4, 12, 13, 15, 17, 18, 20, 26, 27, 28, 30,{\ldots}  72.489937
2  13     [1, 3, 4, 5, 6, 8, 22, 23, 24, 25, 27, 34, 35]  65.088863
3   9                   [3, 6, 7, 9, 11, 15, 16, 21, 26]  65.193806
4  15  [3, 4, 5, 9, 12, 13, 15, 17, 18, 19, 21, 27, 3{\ldots}  70.587435
{\ldots}
     s*                                        regressors*         Cp
295  11            [1, 2, 3, 4, 8, 12, 13, 14, 27, 29, 36]  66.259638
296  16  [3, 4, 5, 6, 7, 10, 13, 14, 20, 24, 26, 27, 29{\ldots}  63.975051
297   4                                    [6, 16, 17, 26]  63.032251
298  23  [3, 4, 5, 7, 9, 10, 13, 14, 15, 16, 18, 20, 21{\ldots}  76.886979
299  19  [3, 6, 7, 8, 9, 11, 12, 14, 15, 16, 17, 19, 20{\ldots}  78.850904

Optimal:
	s* = 6
	regressors = [3, 4, 7, 16, 19, 27]
================================
RANDOM INCLUDING WITH K = 500
================================

   s*                                        regressors*         Cp
0  10              [3, 5, 6, 16, 19, 21, 23, 24, 28, 33]  72.510077
1  16  [2, 3, 4, 5, 6, 11, 13, 16, 20, 21, 24, 25, 26{\ldots}  63.010999
2  22  [4, 6, 7, 8, 9, 11, 14, 16, 17, 20, 21, 22, 23{\ldots}  76.964328
3  18  [1, 2, 4, 7, 10, 12, 15, 17, 18, 22, 23, 24, 2{\ldots}  76.563448
4  22  [1, 3, 4, 6, 8, 11, 12, 13, 15, 16, 17, 18, 19{\ldots}  77.953536
{\ldots}
     s*                                        regressors*         Cp
495  29  [2, 5, 6, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18{\ldots}  92.359643
496  20  [1, 5, 6, 7, 9, 10, 11, 12, 13, 16, 18, 21, 22{\ldots}  79.857308
497  14  [1, 7, 8, 9, 10, 12, 15, 16, 17, 23, 26, 31, 3{\ldots}  77.205777
498  19  [2, 3, 5, 6, 10, 11, 12, 13, 15, 16, 17, 19, 2{\ldots}  79.754996
499  15  [1, 3, 4, 6, 11, 13, 14, 15, 17, 18, 21, 22, 2{\ldots}  66.134954

Optimal:
	s* = 9
	regressors = [3, 4, 6, 7, 9, 12, 13, 14, 26]
================================
RANDOM INCLUDING WITH K = 1000
================================

   s*                                        regressors*         Cp
0  10             [1, 4, 11, 17, 21, 22, 24, 27, 35, 36]  71.556395
1  24  [1, 3, 4, 6, 7, 8, 9, 10, 11, 14, 15, 16, 17, {\ldots}  78.606533
2  27  [2, 4, 5, 6, 8, 9, 10, 11, 15, 16, 17, 18, 19,{\ldots}  85.401718
3  14  [4, 5, 7, 8, 10, 12, 16, 17, 18, 25, 27, 30, 3{\ldots}  67.357648
4  18  [1, 7, 8, 11, 13, 14, 16, 20, 21, 22, 23, 24, {\ldots}  84.101391
{\ldots}
     s*                                        regressors*         Cp
995  21  [1, 2, 4, 5, 6, 8, 9, 10, 13, 16, 18, 19, 23, {\ldots}  73.994861
996  21  [2, 3, 4, 6, 8, 11, 13, 14, 15, 17, 18, 19, 20{\ldots}  77.655959
997  27  [2, 3, 4, 5, 7, 9, 10, 11, 12, 13, 14, 15, 17,{\ldots}  86.254461
998  15  [4, 5, 8, 12, 13, 14, 19, 21, 22, 27, 29, 30, {\ldots}  72.028169
999  23  [1, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 17, 18,{\ldots}  77.208763

Optimal:
	s* = 6
	regressors = [4, 5, 6, 16, 17, 29]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}297}]:} \PY{n}{Ks} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{2000}\PY{p}{]}
          \PY{k}{for} \PY{n}{K} \PY{o+ow}{in} \PY{n}{Ks}\PY{p}{:}
              \PY{n}{config3}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}random\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n}{K}\PY{o}{=}\PY{n}{K}\PY{p}{,} \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                             \PY{n}{main\PYZus{}criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
================================
RANDOM INCLUDING WITH K = 2000
================================

   s*                                        regressors*         Cp
0  20  [1, 4, 6, 8, 12, 13, 14, 15, 17, 18, 19, 27, 2{\ldots}  77.097628
1  27  [1, 2, 3, 4, 5, 8, 10, 13, 15, 16, 17, 18, 19,{\ldots}  88.701951
2  25  [1, 2, 4, 5, 7, 8, 9, 10, 12, 13, 15, 17, 18, {\ldots}  84.275121
3  14  [2, 4, 5, 7, 8, 10, 16, 17, 18, 23, 24, 27, 31{\ldots}  67.502929
4  13  [1, 2, 6, 17, 19, 22, 23, 24, 25, 27, 28, 30, 34]  86.912595
{\ldots}
      s*                                        regressors*         Cp
1995  17  [4, 5, 6, 10, 14, 17, 18, 19, 21, 22, 26, 28, {\ldots}  80.121412
1996  25  [1, 2, 3, 4, 7, 10, 11, 12, 13, 14, 15, 17, 19{\ldots}  83.557161
1997  23  [3, 7, 8, 9, 10, 11, 14, 15, 16, 17, 18, 19, 2{\ldots}  86.346675
1998  24  [1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, {\ldots}  77.661793
1999  27  [2, 3, 4, 5, 6, 8, 9, 11, 12, 14, 17, 19, 21, {\ldots}  87.589707

Optimal:
	s* = 7
	regressors = [4, 5, 6, 16, 17, 27, 31]

    \end{Verbatim}

    Для цієї задачі будемо аналізувати метод, порівнюючи його результати з
результатами попереднього алгоритму. Видно, що алгоритм нестабільний,
повертає різні комбінації регресорів. Оскільки в цій задачі маємо дуже
багато регресорів (36), то припускаємо, що для побудови хорошої моделі
потрібно виконати дуже багато випадкових генерувань послідовностей,
наприклад \(K\approx1000\). Враховуючи, що попередній метод повертає
такий набір: {[}2, 4, 6, 7, 8, 9, 23, 25, 27, 28, 29{]}, бачимо, що ці
результати перетинаються приблизно наполовину. За цим методом завжди або
часто вважаються впливовими регресори 4, 6, 7, 16, 17 - перші три мають
велику кореляцію з вихідною величиною, а два останні - не дуже велику,
проте їх точно потрібно включати в модель. Нестабільність роботи
алгоритма також може бути спричинена маленьким розміром вибірки
(відносно кількості регресорів) - приблизно 1000, чого скоріш за все
недостатньо.

    \subsection{Пошук моделі. Метод перебірного
включення}\label{ux43fux43eux448ux443ux43a-ux43cux43eux434ux435ux43bux456.-ux43cux435ux442ux43eux434-ux43fux435ux440ux435ux431ux456ux440ux43dux43eux433ux43e-ux432ux43aux43bux44eux447ux435ux43dux43dux44f}

    \subsubsection{Тест 1}\label{ux442ux435ux441ux442-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}300}]:} \PY{n}{total\PYZus{}df}\PY{p}{,} \PY{n}{best\PYZus{}df} \PY{o}{=} \PY{n}{config1}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}picking\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PYZbs{}
                                                          \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                          \PY{n}{main\PYZus{}criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
================================
PICKING INCLUDING
================================
Optimal:
	s* = 3
	regressors = [1, 2, 3]

    \end{Verbatim}

    Таблиця, яка добре демонструє роботу алгоритма (порядок зберігається),
наведена нижче:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}301}]:} \PY{n}{total\PYZus{}df}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}301}]:}     s       regressors          Cp
          0   1              [1]  214.848610
          1   1              [2]  569.137599
          2   1              [3]  389.569791
          3   1              [4]  467.699667
          4   1              [5]  450.006820
          5   2           [1, 2]  118.663149
          6   1              [1]  214.848610
          7   2           [1, 3]  216.599313
          8   2           [1, 4]  203.582136
          9   2           [1, 5]  210.770049
          10  3        [1, 2, 3]   94.017191
          11  3        [1, 2, 4]  119.255285
          12  3        [1, 2, 5]  116.878326
          13  3        [1, 2, 3]   94.017191
          14  4     [1, 2, 3, 4]   96.001499
          15  2           [1, 2]  118.663149
          16  1              [1]  214.848610
          17  4     [1, 2, 3, 5]   95.907950
          18  3        [1, 2, 3]   94.017191
          19  4     [1, 2, 3, 4]   96.001499
          20  5  [1, 2, 3, 4, 5]   97.865019
          21  2           [1, 2]  118.663149
          22  1              [1]  214.848610
\end{Verbatim}
            
    Таблиця, яка містить глобально кращий результат на кожній ітерації
підвищення складності

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}302}]:} \PY{n}{best\PYZus{}df}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}302}]:}   s* regressors*          Cp
          0  1         [1]  214.848610
          1  2      [1, 2]  118.663149
          2  3   [1, 2, 3]   94.017191
          3  3   [1, 2, 3]   94.017191
          4  3   [1, 2, 3]   94.017191
\end{Verbatim}
            
    Отже, для даної задачі алгоритм спрацював добре, він повернув оптимальну
модель.

    \subsubsection{Тест 2}\label{ux442ux435ux441ux442-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}361}]:} \PY{n}{total\PYZus{}df}\PY{p}{,} \PY{n}{best\PYZus{}df} \PY{o}{=} \PY{n}{config2}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}picking\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PYZbs{}
                                                          \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                          \PY{n}{main\PYZus{}criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
================================
PICKING INCLUDING
================================
Optimal:
	s* = 10
	regressors = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

    \end{Verbatim}

    Таблиця, яка добре демонструє роботу алгоритма (порядок зберігається),
наведена нижче:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}362}]:} \PY{n}{total\PYZus{}df}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}362}]:}       s                                         regressors            Cp
          0     1                                                [1]  51604.048344
          1     1                                                [2]  43532.540113
          2     1                                                [3]  40484.057161
          3     1                                                [4]  58348.468954
          4     1                                                [5]  54122.151523
          5     1                                                [6]  48234.238030
          6     1                                                [7]  49261.682679
          7     1                                                [8]  41262.597861
          8     1                                                [9]  42697.150718
          9     1                                               [10]  46688.880859
          10    1                                               [11]  52877.477822
          11    1                                               [12]  58507.010273
          12    1                                               [13]  55668.546912
          13    1                                               [14]  58233.789009
          14    1                                               [15]  58075.530065
          15    2                                             [1, 3]  24296.622435
          16    1                                                [3]  40484.057161
          17    2                                             [2, 3]  18772.260468
          18    2                                             [3, 4]  26296.626841
          19    2                                             [3, 5]  24204.462362
          20    2                                             [3, 6]  20248.008097
          21    2                                             [3, 7]  22516.747018
          22    2                                             [3, 8]  15974.764777
          23    2                                             [3, 9]  18544.806985
          24    2                                            [3, 10]  21234.875517
          25    2                                            [3, 11]  24842.104058
          26    2                                            [3, 12]  26383.747773
          27    2                                            [3, 13]  24859.853694
          28    2                                            [3, 14]  25188.913591
          29    2                                            [3, 15]  26605.828375
          ..   ..                                                {\ldots}           {\ldots}
          109  10                   [2, 3, 4, 5, 6, 7, 8, 9, 10, 12]    127.224293
          110  10                   [2, 3, 4, 5, 6, 7, 8, 9, 10, 13]    127.227733
          111  10                   [2, 3, 4, 5, 6, 7, 8, 9, 10, 14]    127.043925
          112  10                   [2, 3, 4, 5, 6, 7, 8, 9, 10, 15]    126.643167
          113  11                [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]    105.158353
          114  11                [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12]    105.125329
          115  11                [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13]    105.103888
          116  11                [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14]    105.157423
          117  11                [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15]    105.121343
          118  10                    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]    103.158799
          119  11                [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]    105.158353
          120  12            [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]    107.125305
          121   9                       [2, 3, 4, 5, 6, 7, 8, 9, 10]    125.228342
          122   8                          [2, 3, 5, 6, 7, 8, 9, 10]    178.976926
          123   7                             [2, 3, 6, 7, 8, 9, 10]    297.908708
          124   6                                [2, 3, 6, 8, 9, 10]    684.680793
          125   5                                    [2, 3, 6, 8, 9]   1740.698164
          126   4                                       [3, 6, 8, 9]   4250.629045
          127   3                                          [3, 8, 9]   8138.785038
          128   2                                             [3, 8]  15974.764777
          129   1                                                [3]  40484.057161
          130  12            [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13]    107.103842
          131  12            [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14]    107.157069
          132  12            [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 15]    107.120060
          133  13        [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]    109.073276
          134  13        [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14]    109.124952
          135  13        [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15]    109.079281
          136  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]    111.073273
          137  14    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15]    111.013640
          138  15  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}    113.012982
          
          [139 rows x 3 columns]
\end{Verbatim}
            
    Таблиця, яка містить глобально кращий результат на кожній ітерації
підвищення складності

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}363}]:} \PY{n}{best\PYZus{}df}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}363}]:}     s*                      regressors*            Cp
          0    1                              [3]  40484.057161
          1    2                           [3, 8]  15974.764777
          2    3                        [3, 8, 9]   8138.785038
          3    4                     [3, 6, 8, 9]   4250.629045
          4    5                  [2, 3, 6, 8, 9]   1740.698164
          5    6              [2, 3, 6, 8, 9, 10]    684.680793
          6    7           [2, 3, 6, 7, 8, 9, 10]    297.908708
          7    8        [2, 3, 5, 6, 7, 8, 9, 10]    178.976926
          8    9     [2, 3, 4, 5, 6, 7, 8, 9, 10]    125.228342
          9   10  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]    103.158799
          10  10  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]    103.158799
          11  10  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]    103.158799
          12  10  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]    103.158799
          13  10  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]    103.158799
          14  10  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]    103.158799
\end{Verbatim}
            
    Для даної задачі також алгоритм спрацював добре і повернув оптимальну
модель. Час роботи алгоритма тут звісно більший за перший метод
(кореляційного включення), проте менший за другий метод (випадкового
включення) і при цьому повертає правильну структуру, тож в цьому плані є
кращим.

    \subsubsection{Тест 3}\label{ux442ux435ux441ux442-3}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}311}]:} \PY{n}{total\PYZus{}df}\PY{p}{,} \PY{n}{best\PYZus{}df} \PY{o}{=} \PY{n}{config3}\PY{o}{.}\PY{n}{run\PYZus{}single\PYZus{}picking\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PYZbs{}
                                                          \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                          \PY{n}{main\PYZus{}criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
================================
PICKING INCLUDING
================================
Optimal:
	s* = 7
	regressors = [3, 4, 5, 6, 9, 16, 26]

    \end{Verbatim}

    Таблиця, яка добре демонструє роботу алгоритма (порядок зберігається),
наведена нижче:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}312}]:} \PY{n}{total\PYZus{}df}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}312}]:}       s                                         regressors             Cp
          0     1                                                [1]    6922.622699
          1     1                                                [2]  171607.168945
          2     1                                                [3]     595.423285
          3     1                                                [4]    8072.403830
          4     1                                                [5]    8415.507144
          5     1                                                [6]     158.358196
          6     1                                                [7]     175.164569
          7     1                                                [8]  208501.298773
          8     1                                                [9]   69222.239836
          9     1                                               [10]  187787.682459
          10    1                                               [11]   19886.729830
          11    1                                               [12]    5277.995979
          12    1                                               [13]     280.697357
          13    1                                               [14]  119107.026909
          14    1                                               [15]  207716.568406
          15    1                                               [16]     208.827496
          16    1                                               [17]  124823.714740
          17    1                                               [18]  199572.038985
          18    1                                               [19]   20872.240938
          19    1                                               [20]  131690.187233
          20    1                                               [21]   15268.403104
          21    1                                               [22]    3751.889765
          22    1                                               [23]   10822.918605
          23    1                                               [24]  107593.708684
          24    1                                               [25]    4139.687219
          25    1                                               [26]   28801.198215
          26    1                                               [27]   32587.576839
          27    1                                               [28]  109136.079786
          28    1                                               [29]   95121.691000
          29    1                                               [30]  182670.791806
          ..   ..                                                {\ldots}            {\ldots}
          672  31  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      89.009264
          673  31  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      89.051761
          674  31  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      89.120734
          675  31  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      89.106388
          676  32  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      90.880558
          677  32  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      91.006471
          678  32  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      91.048445
          679  32  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      91.117755
          680  32  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      91.103769
          681  33  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      92.767377
          682  33  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      92.800002
          683  33  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      92.878469
          684  33  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      92.855271
          685  34  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      94.695102
          686  34  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      94.766422
          687  34  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      94.739615
          688  35  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      96.693792
          689  35  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      96.668793
          690  25  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      77.229872
          691  26  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      79.226699
          692  27  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      81.226596
          693  28  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      83.149919
          694  29  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      85.148968
          695  30  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      87.124184
          696  31  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      89.120961
          697  32  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      90.880558
          698  33  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      92.767377
          699  34  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      94.695102
          700  35  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      96.693792
          701  36  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14{\ldots}      98.667221
          
          [702 rows x 3 columns]
\end{Verbatim}
            
    Таблиця, яка містить глобально кращий результат на кожній ітерації
підвищення складності

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}313}]:} \PY{n}{best\PYZus{}df}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}313}]:}    s*              regressors*          Cp
          0   1                      [6]  158.358196
          1   2                  [6, 16]   78.361004
          2   3               [4, 6, 16]   54.822413
          3   4            [3, 4, 6, 16]   49.481128
          4   5         [3, 4, 5, 6, 16]   47.128611
          5   6      [3, 4, 5, 6, 9, 16]   45.398392
          6   7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          7   7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          8   7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          9   7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          10  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          11  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          12  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          13  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          14  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          15  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          16  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          17  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          18  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          19  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          20  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          21  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          22  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          23  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          24  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          25  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          26  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          27  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          28  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          29  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          30  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          31  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          32  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          33  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          34  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
          35  7  [3, 4, 5, 6, 9, 16, 26]   44.912894
\end{Verbatim}
            
    Для цієї задачі алгоритм працює довго, (хоча знову не довше ніж другий
метод випадкового включення) і повертає такий набір регресорів {[}3, 4,
5, 6, 9, 16, 26{]}. Багато з них (3, 4, 6, 16, 26) дійсно перетинаються
з результатами попередніх методів.

Якщо об'єднати результати трьох методів для цієї задачі, то отримаємо
такий набір регресорів і такі ваги для них:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}365}]:} \PY{n}{regressors1} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mi}{23}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{,} \PY{l+m+mi}{27}\PY{p}{,} \PY{l+m+mi}{28}\PY{p}{,} \PY{l+m+mi}{29}\PY{p}{\PYZcb{}}
          \PY{n}{regressors2} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{17}\PY{p}{,} \PY{l+m+mi}{27}\PY{p}{,} \PY{l+m+mi}{31}\PY{p}{\PYZcb{}}
          \PY{n}{regressors3} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{26}\PY{p}{\PYZcb{}}
          \PY{n}{total} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{a}\PY{o}{.}\PY{n}{union}\PY{p}{(}\PY{n}{b}\PY{p}{)}\PY{o}{.}\PY{n}{union}\PY{p}{(}\PY{n}{c}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{theta}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{RSS\PYZus{}next}\PY{p}{,} \PY{n}{df} \PY{o}{=} \PY{n}{LSMB}\PY{p}{(}\PY{n}{config3}\PY{o}{.}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{total}\PY{p}{]}\PY{p}{,} \PY{n}{config3}\PY{o}{.}\PY{n}{y}\PY{p}{,}
                                        \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{create\PYZus{}dataframe}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ regressors: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{total}\PY{p}{)}\PY{p}{,} \PY{n}{total}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{   with theta: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{theta}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
17 regressors: [2, 3, 4, 5, 6, 7, 8, 9, 16, 17, 23, 25, 26, 27, 28, 29, 31]
   with theta: [ 1.58490768e-01  1.25658013e-01  3.24787641e-02  2.18965046e-03
  2.52196152e-03  2.70591730e-06  1.24677093e-02 -7.81374595e-04
  9.09810152e-03 -1.72335314e-02  7.60034785e-02  7.21612391e-02
  7.66623610e-05  5.78935734e-03  8.60323900e-03  7.36291655e-03
  1.28642815e-02]

    \end{Verbatim}

    \newpage
    \section{Висновки}\label{ux432ux438ux441ux43dux43eux432ux43aux438}

    Досліджуючи три методи пошуку моделі оптимальної складності, ми
з'ясували - якщо говорити про ефективність алгоритму в контексті
правильної структури і швидкодії, то вона залежить від умов і задачі,
великий вплив на неї мають розмірності вибірок (кількість екземплярів та
кількість регресорів) та наявність шумів. Конкретно для наших трьох
задач: Тест 1 є найпростішим з усіх, і всі алгоритми ефективно
побудували модель; Тест 2 є більш великою задачею, і для нього
найефективнішими виявилися метод кореляційного включення та метод
перебірного включення (хоча останній трохи менше через трохи повільнішу
роботу), а метод випадкового включення також працює добре, проте
потребує великої кількості випадкових генерацій послідовностей; Тест 3 є
реальною задачею, для нього невідомі істинні параметри моделі, але
ефективність алгоритмів очевидна, оскільки з 36 регресорів ми зупинилися
на 17ти найвпливовіших.

    \newpage
    \section{Код
програми}\label{ux43aux43eux434-ux43fux440ux43eux433ux440ux430ux43cux438}

    \subsection{Імпорт необхідних бібліотек,
налаштування}\label{ux456ux43cux43fux43eux440ux442-ux43dux435ux43eux431ux445ux456ux434ux43dux438ux445-ux431ux456ux431ux43bux456ux43eux442ux435ux43a-ux43dux430ux43bux430ux448ux442ux443ux432ux430ux43dux43dux44f}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}237}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{integrate} \PY{k}{import} \PY{n}{odeint}
          \PY{k+kn}{from} \PY{n+nn}{itertools} \PY{k}{import} \PY{n}{permutations}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
          
          \PY{k+kn}{from} \PY{n+nn}{pylab} \PY{k}{import} \PY{n}{rcParams}
          \PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mi}{5}
\end{Verbatim}


    \subsection{Реалізація
МНКО}\label{ux440ux435ux430ux43bux456ux437ux430ux446ux456ux44f-ux43cux43dux43aux43e}

    До реалізації додано обрахування W - розширеної матриці нормальної
системи рівнянь для повної моделі на початку роботи МНКО, і подальше її
використання. Як наслідок, маємо більш оптимізований алгоритм, оскільки
в ньому тепер замість зайвих операцій над частинами однієї й тієї ж
матриці відбувається звернення до частин матриці W.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}238}]:} \PY{k}{def} \PY{n+nf}{LSMB}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{W}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{started}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{sigma\PYZus{}estimation}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                   \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{deep\PYZus{}verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{create\PYZus{}dataframe}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
              \PY{k}{assert} \PY{n}{X}\PY{o}{.}\PY{n}{ndim} \PY{o}{==} \PY{l+m+mi}{2} \PY{o+ow}{and} \PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}
              \PY{n}{m} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
              \PY{k}{if} \PY{n}{started}\PY{p}{:}
                  \PY{n}{W} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{T} \PY{o}{@} \PY{n}{X}\PY{p}{,} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{T} \PY{o}{@} \PY{n}{y}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                  \PY{n}{started} \PY{o}{=} \PY{k+kc}{False}
              \PY{k}{assert} \PY{n}{W}\PY{o}{.}\PY{n}{ndim} \PY{o}{==} \PY{l+m+mi}{2} \PY{o+ow}{and} \PY{n}{W}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n}{m}
              \PY{k}{if} \PY{n}{m} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
                  \PY{k}{if} \PY{n}{create\PYZus{}dataframe}\PY{p}{:}
                      \PY{n}{w}\PY{p}{,} \PY{n}{H\PYZus{}inv}\PY{p}{,} \PY{n}{RSS}\PY{p}{,} \PY{n}{df} \PY{o}{=} \PY{n}{LSMB}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{W}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{p}{,}
                                               \PY{n}{started}\PY{p}{,} \PY{n}{sigma\PYZus{}estimation}\PY{p}{,}
                                               \PY{n}{verbose}\PY{p}{,} \PY{n}{deep\PYZus{}verbose}\PY{p}{,} \PY{n}{create\PYZus{}dataframe}\PY{p}{)}
                      \PY{k}{if} \PY{n}{s} \PY{o+ow}{and} \PY{n}{m} \PY{o}{\PYZgt{}} \PY{n}{s}\PY{p}{:}
                          \PY{k}{return} \PY{n}{w}\PY{p}{,} \PY{n}{H\PYZus{}inv}\PY{p}{,} \PY{n}{RSS}\PY{p}{,} \PY{n}{df}
                  \PY{k}{else}\PY{p}{:}
                      \PY{n}{w}\PY{p}{,} \PY{n}{H\PYZus{}inv}\PY{p}{,} \PY{n}{RSS} \PY{o}{=} \PY{n}{LSMB}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{W}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{p}{,}
                                           \PY{n}{started}\PY{p}{,} \PY{n}{sigma\PYZus{}estimation}\PY{p}{,}
                                           \PY{n}{verbose}\PY{p}{,} \PY{n}{deep\PYZus{}verbose}\PY{p}{,} \PY{n}{create\PYZus{}dataframe}\PY{p}{)}
                      \PY{k}{if} \PY{n}{s} \PY{o+ow}{and} \PY{n}{m} \PY{o}{\PYZgt{}} \PY{n}{s}\PY{p}{:}
                          \PY{k}{return} \PY{n}{w}\PY{p}{,} \PY{n}{H\PYZus{}inv}\PY{p}{,} \PY{n}{RSS} 
                  \PY{c+c1}{\PYZsh{} w is of shape = [m\PYZhy{}1, 1]; H\PYZus{}inv is of shape = [m\PYZhy{}1, m\PYZhy{}1]    }
                  \PY{n}{h} \PY{o}{=} \PY{n}{W}\PY{p}{[}\PY{p}{:}\PY{n}{m}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{m}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{} shape = [m\PYZhy{}1, 1]}
                  \PY{n}{eta} \PY{o}{=} \PY{n}{W}\PY{p}{[}\PY{n}{m}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{m}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{c+c1}{\PYZsh{} shape = [1, 1]}
                  \PY{n}{alpha} \PY{o}{=} \PY{n}{H\PYZus{}inv} \PY{o}{@} \PY{n}{h} \PY{c+c1}{\PYZsh{} shape = [m\PYZhy{}1, 1]}
                  \PY{n}{beta} \PY{o}{=} \PY{n}{eta} \PY{o}{\PYZhy{}} \PY{n}{h}\PY{o}{.}\PY{n}{T} \PY{o}{@} \PY{n}{alpha} \PY{c+c1}{\PYZsh{} shape = [1, 1]}
                  \PY{n}{beta\PYZus{}inv} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{beta} \PY{c+c1}{\PYZsh{} shape = [1, 1]}
                  \PY{n}{gamma} \PY{o}{=} \PY{n}{W}\PY{p}{[}\PY{n}{m}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{c+c1}{\PYZsh{} shape = [1, 1]}
                  \PY{n}{nu} \PY{o}{=} \PY{n}{beta\PYZus{}inv} \PY{o}{*} \PY{p}{(}\PY{n}{gamma} \PY{o}{\PYZhy{}} \PY{n}{h}\PY{o}{.}\PY{n}{T} \PY{o}{@} \PY{n}{w}\PY{p}{)} \PY{c+c1}{\PYZsh{} shape = [1, 1]}
                  \PY{n}{w} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{(}\PY{n}{w} \PY{o}{\PYZhy{}} \PY{n}{nu} \PY{o}{*} \PY{n}{alpha}\PY{p}{,} \PY{n}{nu}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} shape = [m, 1]}
                  \PY{n}{H\PYZus{}next\PYZus{}inv} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{H\PYZus{}inv} \PY{o}{+} \PY{n}{beta\PYZus{}inv} \PY{o}{*} \PY{n}{alpha} \PY{o}{@} \PY{n}{alpha}\PY{o}{.}\PY{n}{T}\PY{p}{,}
                                                     \PY{p}{(}\PY{o}{\PYZhy{}} \PY{n}{beta\PYZus{}inv} \PY{o}{*} \PY{n}{alpha}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                         \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{beta\PYZus{}inv} \PY{o}{*} \PY{n}{alpha}\PY{o}{.}\PY{n}{T}\PY{p}{,} \PY{n}{beta\PYZus{}inv}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                  \PY{n}{RSS\PYZus{}next} \PY{o}{=} \PY{p}{(}\PY{n}{RSS} \PY{o}{\PYZhy{}} \PY{n}{nu}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{beta}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
          
              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{} 1}
                  \PY{n}{H\PYZus{}inv} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                  \PY{n}{eta} \PY{o}{=} \PY{n}{beta} \PY{o}{=} \PY{n}{W}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{c+c1}{\PYZsh{} X[:,\PYZhy{}1].T @ X[:,\PYZhy{}1]}
                  \PY{n}{beta\PYZus{}inv} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{beta}
                  \PY{n}{alpha} \PY{o}{=} \PY{n}{h} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                  \PY{n}{gamma} \PY{o}{=} \PY{n}{W}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{c+c1}{\PYZsh{} X[:,\PYZhy{}1].T @ y}
                  \PY{n}{nu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{beta\PYZus{}inv} \PY{o}{*} \PY{n}{gamma}\PY{p}{]}\PY{p}{)}
                  \PY{n}{w} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{nu}\PY{p}{]}\PY{p}{)}
                  \PY{n}{H\PYZus{}next\PYZus{}inv} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{beta\PYZus{}inv}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
                  \PY{n}{RSS\PYZus{}next} \PY{o}{=} \PY{p}{(}\PY{n}{y}\PY{o}{.}\PY{n}{T} \PY{o}{@} \PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{W}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]} \PY{o}{@} \PY{n}{w}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                  \PY{k}{if} \PY{n}{create\PYZus{}dataframe}\PY{p}{:}
                      \PY{k}{if} \PY{n}{sigma\PYZus{}estimation} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
                          \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                      \PY{k}{else}\PY{p}{:}
                          \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp\PYZus{}simple}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                  
              \PY{k}{if} \PY{n}{verbose}\PY{p}{:}
                  \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{===============================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                  \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{Step }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{)}\PY{p}{)}
                  \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{===============================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                  \PY{k}{if} \PY{n}{deep\PYZus{}verbose}\PY{p}{:}
                      \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{h\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{h}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                      \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{eta\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{eta}\PY{p}{)}\PY{p}{)}
                      \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{alpha}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                      \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{beta}\PY{p}{)}\PY{p}{)}
                      \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{gamma}\PY{p}{)}\PY{p}{)}
                      \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{nu\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{nu}\PY{p}{)}\PY{p}{)}
                      \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{===============================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                  \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZgt{} θ\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{w}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                  \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZgt{} H\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZus{}inv:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{H\PYZus{}next\PYZus{}inv}\PY{p}{)}\PY{p}{)}
                  \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZgt{} RSS\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{RSS\PYZus{}next}\PY{p}{)}\PY{p}{)}
              \PY{k}{if} \PY{n}{create\PYZus{}dataframe}\PY{p}{:}
                  \PY{n}{n} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                  \PY{n}{FPE} \PY{o}{=} \PY{p}{(}\PY{n}{n} \PY{o}{+} \PY{n}{m}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{n} \PY{o}{\PYZhy{}} \PY{n}{m}\PY{p}{)} \PY{o}{*} \PY{n}{RSS\PYZus{}next}
                  \PY{n}{Cp\PYZus{}simple} \PY{o}{=} \PY{n}{RSS\PYZus{}next} \PY{o}{+} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{m}
                  \PY{k}{if} \PY{n}{sigma\PYZus{}estimation} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
                      \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{m}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{RSS\PYZus{}next}\PY{p}{,}
                                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{Cp\PYZus{}simple}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{FPE}\PY{p}{,}
                                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{w}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{,}
                                     \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                  \PY{k}{else}\PY{p}{:}
                      \PY{n}{Cp} \PY{o}{=} \PY{n}{RSS\PYZus{}next} \PY{o}{+} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{sigma\PYZus{}estimation} \PY{o}{*} \PY{n}{m}
                      \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{m}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{RSS\PYZus{}next}\PY{p}{,}
                                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp\PYZus{}simple}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{Cp\PYZus{}simple}\PY{p}{,}
                                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{Cp}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{FPE}\PY{p}{,}
                                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{w}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{,}
                                     \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                  \PY{k}{return} \PY{n}{w}\PY{p}{,} \PY{n}{H\PYZus{}next\PYZus{}inv}\PY{p}{,} \PY{n}{RSS\PYZus{}next}\PY{p}{,} \PY{n}{df}
              \PY{k}{return} \PY{n}{w}\PY{p}{,} \PY{n}{H\PYZus{}next\PYZus{}inv}\PY{p}{,} \PY{n}{RSS\PYZus{}next}
\end{Verbatim}


    \subsection{Реалізація класу моделювання і усіх необхідних
методів}\label{ux440ux435ux430ux43bux456ux437ux430ux446ux456ux44f-ux43aux43bux430ux441ux443-ux43cux43eux434ux435ux43bux44eux432ux430ux43dux43dux44f-ux456-ux443ux441ux456ux445-ux43dux435ux43eux431ux445ux456ux434ux43dux438ux445-ux43cux435ux442ux43eux434ux456ux432}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{class} \PY{n+nc}{ModelConfig}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n}{m} \PY{o}{=} \PY{l+m+mi}{5}
            \PY{n}{n} \PY{o}{=} \PY{l+m+mi}{10}
            \PY{n}{n\PYZus{}grid} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{]}
            \PY{n}{theta} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
            \PY{n}{a} \PY{o}{=} \PY{l+m+mi}{0}
            \PY{n}{b} \PY{o}{=} \PY{l+m+mi}{2}
            \PY{n}{sigma} \PY{o}{=} \PY{l+m+mf}{0.3}
            \PY{n}{s0} \PY{o}{=} \PY{l+m+mi}{3}
            \PY{n}{s} \PY{o}{=} \PY{n}{m}
            
            \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{m}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{s0}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{theta}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{a}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{b}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                         \PY{n}{X}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{n}{m}\PY{p}{:}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m} \PY{o}{=} \PY{n}{m}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s} \PY{o}{=} \PY{n}{m}
                \PY{k}{if} \PY{n}{s0}\PY{p}{:}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s0} \PY{o}{=} \PY{n}{s0}
                \PY{k}{if} \PY{n}{theta}\PY{p}{:}
                    \PY{k}{if} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{theta}\PY{p}{,} \PY{n+nb}{dict}\PY{p}{)} \PY{o+ow}{and} \PY{n}{theta}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{random}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m}\PY{p}{)}
                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta}\PY{p}{[}\PY{p}{:}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s0}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{o}{*}\PY{n}{theta}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{random}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                                 \PY{n}{size}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s0}\PY{p}{)}
                    \PY{k}{elif} \PY{n}{theta} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unknown}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                        \PY{k}{assert} \PY{n}{X} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Please provide data (X)}\PY{l+s+s1}{\PYZsq{}}
                        \PY{k}{assert} \PY{n}{y} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Please provide target values as well (y)}\PY{l+s+s1}{\PYZsq{}}
                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta} \PY{o}{=} \PY{n}{theta}
                    \PY{k}{else}\PY{p}{:}
                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta} \PY{o}{=} \PY{n}{theta}
                \PY{k}{if} \PY{n}{a}\PY{p}{:}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a} \PY{o}{=} \PY{n}{a}
                \PY{k}{if} \PY{n}{b}\PY{p}{:}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{b} \PY{o}{=} \PY{n}{b}
                \PY{k}{if} \PY{n}{X} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                    \PY{k}{assert} \PY{n}{y} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Please provide target values as well (y)}\PY{l+s+s1}{\PYZsq{}}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{X}\PY{p}{)}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{y}\PY{p}{)}
                    \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m}\PY{p}{)} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{shape}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m}
                \PY{k}{else}\PY{p}{:}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{p}{)}
                
            \PY{k}{def} \PY{n+nf}{generate\PYZus{}noise\PYZus{}and\PYZus{}output}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{ksi} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{normal}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sigma}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X} \PY{o}{@} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta} \PY{o}{+} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{ksi}
                
            \PY{k}{def} \PY{n+nf}{compile}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{n}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{sigma}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{n}{n}\PY{p}{:}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n} \PY{o}{=} \PY{n}{n}
                \PY{k}{if} \PY{n}{sigma}\PY{p}{:}
                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sigma} \PY{o}{=} \PY{n}{sigma}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{b}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m}\PY{p}{)}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{generate\PYZus{}noise\PYZus{}and\PYZus{}output}\PY{p}{(}\PY{p}{)}
                
            \PY{k}{def} \PY{n+nf}{show}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{n\PYZus{}limit}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Regressors: m = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m}\PY{p}{)}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True parameters: θ = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta}\PY{p}{)}\PY{p}{)}
                \PY{k}{if} \PY{o+ow}{not} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta}\PY{p}{,} \PY{n+nb}{str}\PY{p}{)}\PY{p}{:}
                    \PY{n}{equation\PYZus{}str} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
                    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{theta\PYZus{}i} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta}\PY{p}{)}\PY{p}{:}
                        \PY{n}{equation\PYZus{}str} \PY{o}{+}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ + (}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{) * x}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{theta\PYZus{}i}\PY{p}{,} \PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
                    \PY{n}{equation\PYZus{}str} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y0 = }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+} \PY{n}{equation\PYZus{}str}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{:}\PY{p}{]}
                    \PY{n+nb}{print}\PY{p}{(}\PY{n}{equation\PYZus{}str}\PY{p}{)}
                    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Noise generation: σ = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sigma}\PY{p}{)}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sample length: n = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n}\PY{p}{)}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{X[:10]:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{n}{n\PYZus{}limit}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y[:10]:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{[}\PY{p}{:}\PY{n}{n\PYZus{}limit}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                
            \PY{k}{def} \PY{n+nf}{show\PYZus{}estimations}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS(m) = }\PY{l+s+si}{\PYZob{}:5.5\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{RSS}\PY{p}{)}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{σ* = }\PY{l+s+si}{\PYZob{}:5.5\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sigma\PYZus{}hat} \PY{o}{*}\PY{o}{*} \PY{o}{.}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
            
            \PY{k}{def} \PY{n+nf}{estimate\PYZus{}sigma}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{RSS} \PY{o}{=} \PY{n}{RMNK}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s}\PY{p}{,}
                                 \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{create\PYZus{}dataframe}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sigma\PYZus{}hat} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{RSS} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2} \PY{o}{/} \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                
            \PY{k}{def} \PY{n+nf}{run\PYZus{}grid\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{estimate\PYZus{}sigma}\PY{p}{(}\PY{p}{)}
                \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}grid}\PY{p}{)}\PY{p}{:} 
                    \PY{k}{for} \PY{n}{j}\PY{p}{,} \PY{n}{sigma} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sigma\PYZus{}grid}\PY{p}{)}\PY{p}{:}
                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{sigma}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{SAMPLE \PYZsh{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i} \PY{o}{*} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}grid}\PY{p}{)} \PY{o}{+} \PY{n}{j} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{CONFUGURATIONS \PYZam{} DATA}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{RLSM ITERATIONS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                        \PY{n}{theta\PYZus{}pred}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{df} \PY{o}{=} \PY{n}{LSMB}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s}\PY{p}{,}
                                                    \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                                    \PY{n}{create\PYZus{}dataframe}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{RESULTS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{PARAMETERS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True values:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{θ: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta}\PY{p}{)}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Estimates:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{θ*: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{theta\PYZus{}pred}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                        \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
                        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s* by Cp:  }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s* by FPE: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                        \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
            
            \PY{k}{def} \PY{n+nf}{run\PYZus{}single\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{p}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{plot}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} 
                                                \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Single LSMB}
        \PY{l+s+sd}{        }
        \PY{l+s+sd}{        p : list or str}
        \PY{l+s+sd}{            if list: permutation indices}
        \PY{l+s+sd}{            if str: one of \PYZsq{}direct\PYZsq{}, \PYZsq{}reverse\PYZsq{}, \PYZsq{}correlation\PYZsq{}}
        \PY{l+s+sd}{                    defines how to create permutation}
        \PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
                \PY{k}{if} \PY{n}{p} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reverse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=============}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{REVERSE}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{=============}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                    \PY{n}{p} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{flip}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                \PY{k}{elif} \PY{n}{p} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{correlation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=====================}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{CORRELATION INCLUDING}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{=====================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                    \PY{n}{correlations} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{cov}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{o}{.}\PY{n}{T}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                    \PY{n}{p} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{correlations}\PY{p}{)}
                    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Correlations with target:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{correlations}\PY{p}{)}\PY{p}{)}
                \PY{k}{elif} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{n+nb}{list}\PY{p}{)}\PY{p}{:}
                    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=============}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{CUSTOM}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{=============}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{k}{else}\PY{p}{:}
                    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=============}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{DIRECT}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{=============}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                    \PY{n}{p} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Regressors order:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{p}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                \PY{n}{theta\PYZus{}pred}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{df} \PY{o}{=} \PY{n}{LSMB}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{p}\PY{p}{]}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s}\PY{p}{,}
                                            \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{create\PYZus{}dataframe}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                    
                \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{p}\PY{p}{[}\PY{p}{:}\PY{n+nb}{int}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{p}{]}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{s}\PY{p}{]}
                \PY{k}{for} \PY{n}{criterion} \PY{o+ow}{in} \PY{n}{criteria}\PY{p}{:}
                    \PY{n}{df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}
                \PY{k}{if} \PY{n}{plot}\PY{p}{:}
                    \PY{k}{for} \PY{n}{criterion} \PY{o+ow}{in} \PY{n}{criteria}\PY{p}{:}
                        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{criterion}\PY{p}{)}
                        \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
                    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
                \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{n}{criteria}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PYZbs{}
                           \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{criteria}\PY{p}{]}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s\PYZus{}opt}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{regressors\PYZus{}opt}\PY{p}{,} \PYZbs{}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta\PYZus{}opt} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta\PYZus{}opt} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta\PYZus{}opt}\PY{p}{,}
                                 \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m} \PY{o}{\PYZhy{}}
                                          \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta\PYZus{}opt}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{p}\PY{p}{)}\PY{p}{]}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Optimal:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{s* = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s\PYZus{}opt}\PY{p}{)}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{regressors = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{regressors\PYZus{}opt}\PY{p}{)}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{theta* = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta\PYZus{}opt}\PY{p}{)}\PY{p}{)}
                \PY{k}{return} \PY{n}{df}
            
            \PY{k}{def} \PY{n+nf}{run\PYZus{}single\PYZus{}full\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,}
                                                     \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=============}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{BRUT FORCE}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{=============}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{)}
                \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{permutations}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                    \PY{n}{p} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{p}\PY{p}{)}
                    \PY{n}{theta\PYZus{}pred}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{df} \PY{o}{=} \PY{n}{LSMB}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{p}\PY{p}{]}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s}\PY{p}{,}
                                                \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{create\PYZus{}dataframe}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                    \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                    \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{p}\PY{p}{[}\PY{p}{:}\PY{n+nb}{int}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{p}{]}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{s}\PY{p}{]}
                    \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{total\PYZus{}df}\PY{p}{,} \PY{n}{df}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                \PY{k}{for} \PY{n}{criterion} \PY{o+ow}{in} \PY{n}{criteria}\PY{p}{:}
                    \PY{n}{total\PYZus{}df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{total\PYZus{}df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}
                \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{total\PYZus{}df}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}
                \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{total\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{n}{criteria}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PYZbs{}
                           \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{criteria}\PY{p}{]}
                \PY{k}{return} \PY{n}{total\PYZus{}df}
            
            \PY{k}{def} \PY{n+nf}{run\PYZus{}single\PYZus{}random\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{K}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}
                                                       \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                       \PY{n}{main\PYZus{}criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{================================}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{RANDOM INCLUDING WITH K = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{================================}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{K}\PY{p}{)}\PY{p}{)}
                \PY{n}{permutations} \PY{o}{=} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m}\PY{p}{)} \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{K}\PY{p}{)}\PY{p}{]}
                \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{)}
                \PY{n}{best\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{main\PYZus{}criterion\PYZus{}value} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{Inf}
                \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{permutations}\PY{p}{:}
                    \PY{n}{p} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{p}\PY{p}{)}
                    \PY{n}{theta\PYZus{}pred}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{df} \PY{o}{=} \PY{n}{LSMB}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{p}\PY{p}{]}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s}\PY{p}{,}
                                                \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{create\PYZus{}dataframe}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                    \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                    \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{p}\PY{p}{[}\PY{p}{:}\PY{n+nb}{int}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{p}{]}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{s}\PY{p}{]}
                    \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{n}{criteria}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
                    \PY{n}{main\PYZus{}criterion\PYZus{}value} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{main\PYZus{}criterion}\PY{p}{]}
                    \PY{k}{if} \PY{n}{main\PYZus{}criterion\PYZus{}value} \PY{o}{\PYZlt{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{main\PYZus{}criterion\PYZus{}value}\PY{p}{:}
                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{main\PYZus{}criterion\PYZus{}value} \PY{o}{=} \PY{n}{main\PYZus{}criterion\PYZus{}value}
                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta\PYZus{}pred} \PY{o}{=} \PY{n}{theta\PYZus{}pred}
                        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s\PYZus{}opt}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{regressors\PYZus{}opt} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}
                                                                 \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
                    \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{total\PYZus{}df}\PY{p}{,} \PY{n}{df}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                    \PY{n}{best\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{best\PYZus{}df}\PY{p}{,} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                \PY{k}{for} \PY{n}{criterion} \PY{o+ow}{in} \PY{n}{criteria}\PY{p}{:}
                    \PY{n}{total\PYZus{}df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{total\PYZus{}df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}
                    \PY{n}{best\PYZus{}df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{best\PYZus{}df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}
                \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{total\PYZus{}df}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}
                \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{total\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{n}{criteria}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PYZbs{}
                           \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{criteria}\PY{p}{]}
                \PY{n}{best\PYZus{}df} \PY{o}{=} \PY{n}{best\PYZus{}df}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PYZbs{}
                          \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{criteria}\PY{p}{]}
                \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{n}{best\PYZus{}df}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{...}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{n}{best\PYZus{}df}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{:}\PY{p}{]}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Optimal:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{s* = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{regressors = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s\PYZus{}opt}\PY{p}{,}
                                                            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{regressors\PYZus{}opt}\PY{p}{)}\PY{p}{)}
                \PY{k}{return} \PY{n}{total\PYZus{}df}\PY{p}{,} \PY{n}{best\PYZus{}df}
            
            \PY{k}{def} \PY{n+nf}{run\PYZus{}single\PYZus{}picking\PYZus{}LSMB\PYZus{}model\PYZus{}selection}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,}
                                                       \PY{n}{criteria}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                       \PY{n}{main\PYZus{}criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{================================}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{PICKING INCLUDING}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{================================}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{K}\PY{p}{)}\PY{p}{)}
                \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{)}
                \PY{n}{best\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{main\PYZus{}criterion\PYZus{}value} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{Inf}
                \PY{n}{remained\PYZus{}indices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{m}\PY{p}{)}\PY{p}{)}
                \PY{n}{regressors\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{k}{while} \PY{n+nb}{len}\PY{p}{(}\PY{n}{remained\PYZus{}indices}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                    \PY{n}{local\PYZus{}main\PYZus{}criterion\PYZus{}value} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{Inf}
                    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{remained\PYZus{}indices}\PY{p}{:}
                        \PY{n}{p} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{regressors\PYZus{}indices} \PY{o}{+} \PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                        \PY{n}{theta\PYZus{}pred}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{df} \PY{o}{=} \PY{n}{LSMB}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{p}\PY{p}{]}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{n+nb}{len}\PY{p}{(}\PY{n}{p}\PY{p}{)}\PY{p}{,}
                                                    \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                                    \PY{n}{create\PYZus{}dataframe}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                        \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                        \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{p}\PY{p}{[}\PY{p}{:}\PY{n+nb}{int}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{p}{]}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{s}\PY{p}{]}
                        \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{n}{criteria}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
                        \PY{n}{main\PYZus{}criterion\PYZus{}value} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{main\PYZus{}criterion}\PY{p}{]}
                        \PY{k}{if} \PY{n}{main\PYZus{}criterion\PYZus{}value} \PY{o}{\PYZlt{}} \PY{n}{local\PYZus{}main\PYZus{}criterion\PYZus{}value}\PY{p}{:}
                            \PY{n}{local\PYZus{}main\PYZus{}criterion\PYZus{}value} \PY{o}{=} \PY{n}{main\PYZus{}criterion\PYZus{}value}
                            \PY{n}{local\PYZus{}df} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{]}
                            \PY{n}{local\PYZus{}i} \PY{o}{=} \PY{n}{i}
                        \PY{k}{if} \PY{n}{main\PYZus{}criterion\PYZus{}value} \PY{o}{\PYZlt{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{main\PYZus{}criterion\PYZus{}value}\PY{p}{:}
                            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{main\PYZus{}criterion\PYZus{}value} \PY{o}{=} \PY{n}{main\PYZus{}criterion\PYZus{}value}
                            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{theta\PYZus{}pred} \PY{o}{=} \PY{n}{theta\PYZus{}pred}
                            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s\PYZus{}opt}\PY{p}{,} \PYZbs{}
                            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{regressors\PYZus{}opt} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
                        \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{total\PYZus{}df}\PY{p}{,} \PY{n}{df}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                    \PY{n}{regressors\PYZus{}indices} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{local\PYZus{}i}\PY{p}{]}
                    \PY{n}{remained\PYZus{}indices}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{n}{local\PYZus{}i}\PY{p}{)}
                    \PY{n}{best\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{best\PYZus{}df}\PY{p}{,} \PY{n}{local\PYZus{}df}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                \PY{k}{for} \PY{n}{criterion} \PY{o+ow}{in} \PY{n}{criteria}\PY{p}{:}
                    \PY{n}{total\PYZus{}df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{total\PYZus{}df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}
                    \PY{n}{best\PYZus{}df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{best\PYZus{}df}\PY{p}{[}\PY{n}{criterion}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}
                \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{total\PYZus{}df}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PYZbs{}
                           \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{criteria}\PY{p}{]}
        \PY{c+c1}{\PYZsh{}         total\PYZus{}df = total\PYZus{}df.sort\PYZus{}values(by=criteria).reset\PYZus{}index()\PYZbs{}}
        \PY{c+c1}{\PYZsh{}                    [[\PYZsq{}s\PYZsq{}, \PYZsq{}regressors\PYZsq{}] + criteria]}
                \PY{n}{best\PYZus{}df} \PY{o}{=} \PY{n}{best\PYZus{}df}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PYZbs{}
                          \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{regressors*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{criteria}\PY{p}{]}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Optimal:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{s* = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{regressors = }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{s\PYZus{}opt}\PY{p}{,}
                                                            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{regressors\PYZus{}opt}\PY{p}{)}\PY{p}{)}
                \PY{k}{return} \PY{n}{total\PYZus{}df}\PY{p}{,} \PY{n}{best\PYZus{}df}
\end{Verbatim}



    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
